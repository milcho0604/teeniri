
## 팀원

<center>
  
| 팀장 | 팀원 | 팀원 | 팀원 | 팀원 |
|:------:|:------:|:------:|:------:|:------:|
| 김창현 | 김정은 | 이예나 | 이한아 | 황요한 |
| ![김창현](https://github.com/user-attachments/assets/6cbde653-2dc2-41bc-967b-98c385ca0324) | ![김정은](https://github.com/user-attachments/assets/39f023ed-c272-4218-b11c-c03c2c51ed5e) | ![이예나](https://github.com/user-attachments/assets/50ca9133-e2ab-4d45-b4ee-200bc1f21f31) | ![이한아](https://github.com/user-attachments/assets/29f30df2-465e-45e3-925a-c84bdb003a72) | ![황요한](https://github.com/user-attachments/assets/f69d21a0-496b-46e3-b380-3443a905a791) |

</center>
<br><br>

## ✏️TEENKIRI: 초등학생을 위한 온라인 교육 사이트

TEENKIRI는 초등학생을 위한 혁신적인 온라인 교육 플랫폼입니다. 현대 사회에서 교육의 질은 학생의 미래를 결정짓는 중요한 요소입니다. TEENKIRI는 모든 학생이 차별 없이 양질의 교육을 받을 수 있도록, 무료로 최고의 학습 콘텐츠를 제공합니다.

<br>

## 💡프로젝트 목표

TEENKIRI의 목표는 무상으로 제공되는 고품질 교육을 통해 경제적 격차로 인한 교육 불평등을 해소하고, 모든 학생에게 공정한 교육 기회를 제공하는 것입니다. 이를 통해 학부모의 경제적 부담을 줄이고, 학생들이 자신의 잠재력을 최대한 발휘할 수 있도록 지원합니다.
<br>


## 주요 기능

| 기능 | 설명 |
|------|------|
| **간편한 회원가입** | 구글 로그인 또는 이메일 인증을 통한 간편한 회원가입으로, 학생들은 빠르고 쉽게 TEENKIRI의 모든 강의를 수강할 수 있습니다. |
| **다양한 강좌** | 과목별로 다채로운 강좌와 강의를 그리고 추천목록을 제공하여 학생들이 자신에게 맞는 선생님과 강좌를 자유롭게 선택할 수 있습니다. |
| **온라인 영상 강의** | 언제 어디서든 수강 가능한 고품질 녹화 강의를 제공하여 학생들이 자신의 학습 속도에 맞춰 체계적으로 학습하고 진행률을 확인할 수 있습니다. |
| **소통 기능** | 채팅, 자유게시판, 댓글 등을 통해 다른 학생들과 자유롭게 의견을 나누고 소통할 수 있습니다. |
| **질의응답 시스템** | 학습 중 어려운 부분이나 궁금한 점이 생기면 사진이나 글로 질문을 남길 수 있으며, 실시간 알림을 통해 해당 강좌의 강사가 신속하고 정확한 답변을 제공합니다. |
| **실시간 알림** | 질문에 대한 답변이나 댓글 알림을 학생들에게 실시간으로 전달하여 빠르고 원활한 학습 환경을 지원합니다. |
| **실시간 채팅** | 과목별 실시간 채팅을 이용하여, 궁금한 점이 생기면 사용자간 실시간으로 질문을 주고 받을 수 있습니다. |
| **신고 기능** | 부적절한 게시글이나 댓글, 채팅을 신고하여 관리하며, 안전하고 건전한 학습 환경을 유지합니다. |
<br>

## API 명세서
[API 명세서](https://www.notion.so/ara-boka/fc5d0810549e4d1b824bbbaba4e4a317?v=7d45cf341d364c86aaf799a90e747692&pvs=4)

## 스택

### BACKEND
![Java](https://img.shields.io/badge/java-007396?style=for-the-badge&logo=java&logoColor=white)
![Spring](https://img.shields.io/badge/spring-6DB33F?style=for-the-badge&logo=spring&logoColor=white)
![socketdotio](https://img.shields.io/badge/socketdotio-010101?style=for-the-badge)


###  DB
![mariadb](https://img.shields.io/badge/mariadb-003545?style=for-the-badge&logo=mariadb&logoColor=white)
![redis](https://img.shields.io/badge/redis-FF4438?style=for-the-badge)
![amazons3](https://img.shields.io/badge/amazons3-569A31?style=for-the-badge)

### TOOLS
![Notion](https://img.shields.io/badge/notion-181717?style=for-the-badge&logo=notion&logoColor=white)
![Git](https://img.shields.io/badge/git-F05032?style=for-the-badge&logo=git&logoColor=white)
![GitHub](https://img.shields.io/badge/Github-181717?style=for-the-badge&logo=Github&logoColor=white)
![Gather](https://img.shields.io/badge/gather-2F5EF5?style=for-the-badge)
![figma](https://img.shields.io/badge/figma-2F5EF5?style=for-the-badge)
![github-actions](https://img.shields.io/badge/github%20actions-2088FF?style=for-the-badge)
![postman](https://img.shields.io/badge/postman-F05032?style=for-the-badge&logo=postman&logoColor=white)

### 배포툴

![kubernetes](https://img.shields.io/badge/kubernetes-326CE5?style=for-the-badge&logo=kubernetes&logoColor=white)
![nginx](https://img.shields.io/badge/nginx-009639?style=for-the-badge&logo=nginx&logoColor=white)
![amazonec2](https://img.shields.io/badge/amazonec2-FF9900?style=for-the-badge&logo=amazonec2&logoColor=white)

## WBS

[WBS 보기](https://docs.google.com/spreadsheets/d/120qVjj7PFPoHNYqx8IHpAQztUI7F3E29oSD8xP9Lv3Y/edit?pli=1&gid=95638865#gid=95638865)

## 프로젝트 요구사항 명세서

[요구사항 명세서 보기](https://docs.google.com/spreadsheets/d/120qVjj7PFPoHNYqx8IHpAQztUI7F3E29oSD8xP9Lv3Y/edit?pli=1&gid=0#gid=0)
<br>

## ER Diagram
<br>

![Teenieping](https://github.com/user-attachments/assets/e7a4b2f6-ba62-4fcf-b8f1-b076d0db859d)


## 배포 아키텍쳐
![틴키리배포](https://github.com/user-attachments/assets/fea977dc-5e98-476b-8828-459dfad0c1d6)


<br>

### 아키텍쳐 선택이유
|  | **Kubernetes** | docker compose |
|:------:|:------:|:------:|
| 아키텍처 | 다중호스트 | 단일호스트|
|확상성|Scale-Out|Scale-Up 
|로드밸런싱|자동설정|직접설정
|HA|장애 감지 및 자동 복구| 장애 발생 시 서비스 다운
|설정편의성|내부 서비스 디스커버리 자동 설정 | 서비스의 IP 주소나 도메인을 직접 지정|

<br><br>

## 시스템 아키텍쳐
### 백엔드 아키텍쳐
![백엔드아키텍쳐](https://github.com/user-attachments/assets/53f6f1eb-13c2-46de-951d-059a298a2b5e)
<br>
<details>
  <summary>통신플로우</summary>
  <img src="https://github.com/user-attachments/assets/a5c9e695-5d42-4d8c-bf0f-0e2914bcd0cf">
  <img src="https://github.com/user-attachments/assets/8b8a8a56-00da-402b-8d8e-d187f81f008c">
  <img src="https://github.com/user-attachments/assets/ced481be-325d-4dcb-b52b-826d4e9065c4">
</details>
<br>
<details>
  <summary> 세션 로그인 플로우</summary>
  <img src="https://github.com/user-attachments/assets/048135b9-f2ad-43ed-9b99-50f35abe0898">
</details>

## 구성 스크립트

<details>
  <summary> Back-End</summary>
  <details>
    <summary>teenkiri_k8s.yml</summary>
    
      name: deploy ordersystem with k8s
      on:
        push:
          branches:
            - main
      jobs:
        build-and-deploy:
          runs-on: ubuntu-latest
          steps:
            - name: checkout github (source code checkout)
              uses: actions/checkout@v2
            
            - name: install kubectl
              uses: azure/setup-kubectl@v3
              with:
                version: "v1.25.9"
              id: install

            - name: configure aws (key setting)
              uses: aws-actions/configure-aws-credentials@v1
              with:
                aws-access-key-id: ${{secrets.AWS_KEY}}
                aws-secret-access-key: ${{secrets.AWS_SECRET}}
                aws-region: ap-northeast-2

            - name: update cluster information
              run : aws eks update-kubeconfig --name teenkiri-cluster --region ap-northeast-2

            - name: login ECR
              id: login-ecr
              uses: aws-actions/amazon-ecr-login@v1

            - name: build and push docker images to ecr (env:변수명지정)
              env:
                REGISTRY: 346903264902.dkr.ecr.ap-northeast-2.amazonaws.com
                REPOSITORY: teenkiri
              run: |
                docker build -t $REGISTRY/$REPOSITORY:latest -f ./Dockerfile .
                docker push $REGISTRY/$REPOSITORY:latest

            - name: eks kubectl apply
              run: |
                kubectl apply -f ./k8s/teenkiri_depl.yml
                kubectl rollout restart deployment teenkiri-deployment -n teenkiri
              

  </details>

  <details>
    <summary> certificate.yml</summary>

      apiVersion: cert-manager.io/v1
      kind: ClusterIssuer
      metadata:
        name: letsencrypt-prod
      spec:
        acme:
          # 인증서 서버 주소. 해당 서버의 리소스를 통해 인증서 발행
          server: https://acme-v02.api.letsencrypt.org/directory
          email: snikuz12@naver.com
          privateKeySecretRef:
            name: letsencrypt-prod
          solvers:
          - http01:
              ingress:
                class: nginx
      # 3. Certificate 생성
      ---
      apiVersion: cert-manager.io/v1
      kind: Certificate
      metadata:
        name: teenkiri-com-tls
        namespace: teenkiri
      spec:
        secretName: teenkiri-com-tls
        duration: 2160h # 90일
        renewBefore: 36h # 15일전에 갱신
        issuerRef:
          name: letsencrypt-prod
          kind: ClusterIssuer
        commonName: server.teenkiri.site
        dnsNames:
          - server.teenkiri.site
      
  </details>

  <details>
    <summary> teenkiri_depl.yml</summary>
    
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      name: teenkiri-deployment
      namespace: teenkiri
    spec:
      replicas: 3
      selector:
        matchLabels:
          app: teenkiri
      template:
        metadata:
          labels:
            app: teenkiri
        spec:
          containers:
            - name: teenkiri
              image: 346903264902.dkr.ecr.ap-northeast-2.amazonaws.com/teenkiri:latest
              ports:
                - containerPort: 8080
              resources:
                limits:
                  cpu: "1"
                  memory: "500Mi"
                requests:
                  cpu: "0.5"
                  memory: "500Mi"

              env:
                - name: REDIS_HOST
                  valueFrom:
                    secretKeyRef:
                      key: REDIS_HOST
                      name: teenkiri-app-secrets
                - name: REDIS_PORT
                  valueFrom:
                    secretKeyRef:
                      key: REDIS_PORT
                      name: teenkiri-app-secrets
                - name: DB_HOST
                  valueFrom:
                    secretKeyRef:
                      key: DB_HOST
                      name: teenkiri-app-secrets
                - name: DB_USERNAME
                  valueFrom:
                    secretKeyRef:
                      key: DB_USERNAME
                      name: teenkiri-app-secrets
                - name: DB_PASSWORD
                  valueFrom:
                    secretKeyRef:
                      key: DB_PASSWORD
                      name: teenkiri-app-secrets
                - name: JWT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: JWT_SECRET
                      name: teenkiri-app-secrets
                - name: JWT_SECRET_RT
                  valueFrom:
                    secretKeyRef:
                      key: JWT_SECRET_RT
                      name: teenkiri-app-secrets
                - name: AWS_ACCESS_KEY
                  valueFrom:
                    secretKeyRef:
                      key: AWS_ACCESS_KEY
                      name: teenkiri-app-secrets
                - name: AWS_SECRET_KEY
                  valueFrom:
                    secretKeyRef:
                      key: AWS_SECRET_KEY
                      name: teenkiri-app-secrets
                - name: JWT_TIME
                  valueFrom:
                    secretKeyRef:
                      key: JWT_TIME
                      name: teenkiri-app-secrets
                - name: JWT_TIME_RT
                  valueFrom:
                    secretKeyRef:
                      key: JWT_TIME_RT
                      name: teenkiri-app-secrets
                - name: GOOGLE_TOKEN
                  valueFrom:
                    secretKeyRef:
                      key: GOOGLE_TOKEN
                      name: teenkiri-app-secrets
                - name: GOOGLE_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: GOOGLE_SECRET
                      name: teenkiri-app-secrets
                - name: KAKAO_TOKEN
                  valueFrom:
                    secretKeyRef:
                      key: KAKAO_TOKEN
                      name: teenkiri-app-secrets
                - name: KAKAO_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: KAKAO_SECRET
                      name: teenkiri-app-secrets
                - name: NAVER_TOKEN
                  valueFrom:
                    secretKeyRef:
                      key: NAVER_TOKEN
                      name: teenkiri-app-secrets
                - name: NAVER_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: NAVER_SECRET
                      name: teenkiri-app-secrets
                - name: AUTH_HOST
                  valueFrom:
                    secretKeyRef:
                      key: AUTH_HOST
                      name: teenkiri-app-secrets
                - name: AUTH_PORT
                  valueFrom:
                    secretKeyRef:
                      key: AUTH_PORT
                      name: teenkiri-app-secrets
                - name: AUTH_EMAIL
                  valueFrom:
                    secretKeyRef:
                      key: AUTH_EMAIL
                      name: teenkiri-app-secrets
                - name: AUTH_KEY
                  valueFrom:
                    secretKeyRef:
                      key: AUTH_KEY
                      name: teenkiri-app-secrets
                - name: BUCKET
                  valueFrom:
                    secretKeyRef:
                      key: BUCKET
                      name: teenkiri-app-secrets

  </details>

  <details>
    <summary> teenkiri_ingress.yml</summary>

    apiVersion: networking.k8s.io/v1
    kind: Ingress
    metadata:
      name: teenkiri-ingress
      namespace: teenkiri
      annotations:
        nginx.ingress.kubernetes.io/proxy-body-size: "3G"
        nginx.ingress.kubernetes.io/client-body-buffer-size: "3G"
        nginx.ingress.kubernetes.io/affinity: "cookie"  # 세션 스티키니스 활성화
        nginx.ingress.kubernetes.io/session-cookie-name: "teenkiri-session"  # 세션 쿠키 이름
        nginx.ingress.kubernetes.io/session-cookie-hash: "sha1"  # 쿠키 해시 알고리즘
        kubernetes.io/ingress.class: nginx
        cert-manager.io/cluster-issuer: letsencrypt-prod
    spec:
      tls:
        - hosts:
            - "server.teenkiri.site"
          secretName: teenkiri-com-tls
      rules:
        - host: server.teenkiri.site
          http:
            paths:
              - path: /
                pathType: Prefix
                backend:
                  service:
                    name: teenkiri-service
                    port:
                      number: 80
  </details>

  <details>
    <summary>teenkiri_service.yml</summary>

    apiVersion: v1
    kind: Service
    metadata:
      name: teenkiri-service
      namespace: teenkiri  
    spec:
      type: ClusterIP
      ports:
        - name: http
          port: 80
          targetPort: 8080
        - name: tomcat
          port: 8090
          targetPort: 8090
      selector:
        app: teenkiri

  </details>

  <details>
    <summary> Configmap.yml</summary>
    
    apiVersion: v1
    kind: ConfigMap
    metadata:
      name: nginx-configuration
      namespace: ingress-nginx
    data:
      proxy-body-size: "3G"
      client-body-buffer-size: "3G"   
  </details>
</details>

## 시행착오 관련 사항

<details>
  <summary> 소셜로그인 오류 이유</summary>
  <img src = "https://github.com/user-attachments/assets/ceca1543-6aa2-4236-8dec-efa325772c11"> 
</details>

<details>
  <summary> 소셜로그인 오류 해결</summary>
  <img src = "https://github.com/user-attachments/assets/048135b9-f2ad-43ed-9b99-50f35abe0898">
</details>

<details>
  <summary> 파일업로드</summary>
  nginx 파일크기 미설정으로 인한 오류
  <img src = "https://github.com/user-attachments/assets/78a01dfd-5ce3-40ea-aea2-fb97fbe3329b">
  tomcat 파일크기 미설정으로 인한 오류
  <img src = "https://github.com/user-attachments/assets/4cc4cdc3-736d-4022-a758-8ca3d45681d9">
</details>

<details>
  <summary> ingress.yml 수정내역</summary>
  
  ```
      nginx.ingress.kubernetes.io/affinity: "cookie"  # 세션 스티키니스 활성화
      nginx.ingress.kubernetes.io/session-cookie-name: "teenkiri-session"  # 세션 쿠키 이름
      nginx.ingress.kubernetes.io/session-cookie-hash: "sha1"  # 쿠키 해시 알고리즘
  ```
</details>

<details>
  <summary> ingress.yml 수정내역</summary>
  
  ```
      nginx.ingress.kubernetes.io/affinity: "cookie"  # 세션 스티키니스 활성화
      nginx.ingress.kubernetes.io/session-cookie-name: "teenkiri-session"  # 세션 쿠키 이름
      nginx.ingress.kubernetes.io/session-cookie-hash: "sha1"  # 쿠키 해시 알고리즘
  ```
</details>

<details>
  <summary> application.yml 수정내역</summary>
  
  ```
    spring:
      servlet:
        multipart:
          max-file-size: 3GB   # 파일당 최대 크기
          max-request-size: 3GB  # 전체 요청 크기
  ```
</details>


## 프로젝트 시연

#### 👤 로그인, 회원가입
<details>
  <summary>회원가입 및 로그인, 회원탈퇴</summary>
  <img src="https://github.com/user-attachments/assets/4cc8f76e-4b72-4a83-a12b-d6811b53b024">
</details>

<details>
  <summary>구글 로그인</summary>
  <img src="https://github.com/user-attachments/assets/fc8a4280-55c5-42bb-87d9-194c0f93bf6d">
</details>

<details>
  <summary>카카오 로그인</summary>
  <img src="https://github.com/user-attachments/assets/cd6cc14e-c548-4fc4-b4c4-4541cad0351b">
</details>

<details>
  <summary>아이디 저장</summary>
  <img src="https://github.com/user-attachments/assets/271e8b47-4686-4949-9ee8-fd7c3d98414a">
</details>

<details>
  <summary>아이디 찾기</summary>
  <img src="https://github.com/user-attachments/assets/8dc01686-587a-4ae7-94ce-c8c9ef840a33">
</details>

<details>
  <summary>비밀번호 찾기</summary>
  <img src = "https://github.com/user-attachments/assets/31659318-a183-4825-9c6c-1a1f4fe5d9e3">
</details>

<details>
  <summary>비밀번호 재설정 링크 사용자 이메일로 전송</summary>
  <img width="1170" alt="비밀번호_재설정_링크" src="https://github.com/user-attachments/assets/d1d59ff7-ec19-4d0b-ae60-9d00ccc7128c">
</details>

<details>
  <summary>구글 로그인</summary>
<img src = "https://github.com/user-attachments/assets/6adbcfab-2034-4241-af68-9a29ea2bd0ad">
</details>

<details>
  <summary>id 저장</summary>
  <img src = "https://github.com/user-attachments/assets/f0aba189-fd64-4381-b8ce-dec71f413cb9">
</details>

<details>
  <summary>로그인 및 로그아웃</summary>
<br>
<summary>로그인</summary>
<img src ="https://github.com/user-attachments/assets/a2f71dc3-a939-4c40-a3da-964b0ed6dd87">
<br>
  <summary>로그아웃</summary>
<img src ="https://github.com/user-attachments/assets/ac47c3f1-f6d9-44c4-8c3f-d10393a46e89">
</details>

<details>
  <summary>회원탈퇴</summary>
  <img src = "https://github.com/user-attachments/assets/9bf702fe-421f-45af-8f5f-90e01fb997c5">
</details>

<details>
  <summary>회원탈퇴 확인</summary>
  <img src = "https://github.com/user-attachments/assets/24022045-7afc-4a79-9c6c-433811b8ac14">
</details>

#### 📚 강좌 및 강의

<details>
  <summary>강좌 생성 및 강좌 리스트, 강좌 상세</summary>
  <img src="https://github.com/user-attachments/assets/531492fd-d958-40b2-ae54-912b8159e80c">
</details>

<details>
  <summary>강좌 추천</summary>
  <img src="https://github.com/user-attachments/assets/99f3a64f-570b-4c38-bf96-32972a88d6b2">
</details>

<details>
  <summary>강좌 수강신청 및 내가 수강중인 강좌 리스트</summary>
  <img src="https://github.com/user-attachments/assets/f968dfa0-8316-4fe1-8649-674f50c10ac5">
</details>

<details>
  <summary>강의 시청 플레이어, 강의 진행률 서버와 통신, 강의 수강완료 여부 통신</summary>
  <img src= "https://github.com/user-attachments/assets/f7ff0202-637b-4e0b-a25a-606fc532c506">
</details>

<details>
  <summary>강의 후기 작성 및 조회</summary>
  <img src="https://github.com/user-attachments/assets/ff13b853-5ae3-4912-9e99-fa06d87a334c" alt="별점 및 후기">
</details>

<details>
  <summary>강좌 찜, 찜 목록</summary>
  <img src="https://github.com/user-attachments/assets/f5046e16-c634-42a8-a4fd-f6477be81e82">
</details>


#### 📋 게시판

<details>
  <summary>자유게시판 검색</summary>
  <img src="https://github.com/user-attachments/assets/9d2d7b5b-ebe9-4a41-9783-ffd881b72362">
</details>

<details>
  <summary>자유게시판 작성, 수정, 삭제, 댓글, 신고</summary>
  <img src = "https://github.com/user-attachments/assets/bb5b3ce2-22ad-430d-91f9-4a63035acc82">
</details>

<details>
  <summary>질문 게시판 검색</summary>
  <img src = "https://github.com/user-attachments/assets/d21a2480-c7b3-4cf0-bfff-f376c90677e9">
</details>

<details>
  <summary>질문 게시판 작성, 수정, 삭제, 댓글, 신고, 알림</summary>
  <img src= "https://github.com/user-attachments/assets/849eccc6-42da-4238-bc25-e9f3e112923e">
</details>

#### 💬 실시간 채팅

<details>
  <summary>실시간 채팅</summary>
  <img src= "https://github.com/user-attachments/assets/c73dcbd6-9cff-46b1-88f5-4486eb3f6eed">
</details>

#### 🔔 알림

<details>
  <summary>알림 드롭다운, 알림 목록 조회</summary>
  <img src = "https://github.com/user-attachments/assets/5b904e40-f5b0-4864-ae66-4903ea1d1532">
</details>

#### 🚨 신고

<details>
  <summary>게시판별 신고 목록 - 관리자</summary>
  <img src= "https://github.com/user-attachments/assets/3fc0e9f5-54ba-4c33-88fa-be6c36749ea1">
</details>

<details>
  <summary>신고 누적으로 계정 정지된 회원 확인 - 관리자</summary>
  <img src= "https://github.com/user-attachments/assets/aaec10bb-8898-4921-94f4-1f9188ca6e47">
</details>

<details>
  <summary> 회원 탈퇴 처리 확인</summary>
  <img src= "https://github.com/user-attachments/assets/2d1eb4e4-8188-4f45-9b3e-ac0d978ebe1a">
</details>
